"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();Object.defineProperty(exports,"__esModule",{value:!0});var _react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_UIView2=require("../UIView"),_UIView3=_interopRequireDefault(_UIView2),_UISegmentedControl=require("../UISegmentedControl"),_UISegmentedControl2=_interopRequireDefault(_UISegmentedControl),_UIList=require("../UIList"),_UIList2=_interopRequireDefault(_UIList),_UIButton=require("../UIButton"),_UIButton2=_interopRequireDefault(_UIButton),_item=require("./item"),_item2=_interopRequireDefault(_item),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_noop=require("../UIUtils/noop"),_noop2=_interopRequireDefault(_noop),UIPaginatedView=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"initialState",value:function(){return{currentPage:this.props.pagerPosition,numberOfPages:Math.ceil(this.props.totalItems/this.props.numItemsPerPage),numItemsPerPage:this.props.numItemsPerPage,numPageToggles:this.props.numPageToggles,totalItems:this.props.totalItems,items:[{data:this.props.getItem(0)}],shownItems:[{data:this.props.getItem(0)}]}}},{key:"componentDidUpdate",value:function(e,t){t.currentPage!==this.state.currentPage&&this.refs.itemList.refs.item_0.focus()}},{key:"componentDidMount",value:function(){this.setState({shownItems:this.generateItems(this.state.currentPage)})}},{key:"createPageButtonOptions",value:function(){var e=[],r=this.state.numberOfPages,s=this.state.currentPage,a=this.props.numPageToggles,o=s-(s-1)%a,n=Math.min(o+a-1,r);this.props.showJumpToFirst&&e.push({selected:!1,content:this.props.jumpToFirstControlText,value:t.controlValues.FIRST,disabled:1===this.state.currentPage,className:"ui-paginated-view-controls-first"}),e.push({selected:!1,content:this.props.previousPageControlText,value:t.controlValues.PREVIOUS,disabled:1===this.state.currentPage,className:"ui-paginated-view-controls-previous"});for(var i=o;n>=i;i++)e.push({selected:i===this.state.currentPage,content:i,value:i});return e.push({selected:!1,content:this.props.nextPageControlText,value:t.controlValues.NEXT,disabled:this.state.currentPage===this.state.numberOfPages,className:"ui-paginated-view-controls-next"}),this.props.showJumpToLast&&e.push({selected:!1,content:this.props.jumpToLastControlText,value:t.controlValues.LAST,disabled:this.state.currentPage===this.state.numberOfPages,className:"ui-paginated-view-controls-last"}),e}},{key:"currentPage",value:function(){return this.state.currentPage}},{key:"generateItems",value:function(e){for(var t=[],r=(e-1)*this.state.numItemsPerPage,s=Math.min(this.state.totalItems,r+this.state.numItemsPerPage)-1,a=r;s>=a;a++)t.push({data:this.props.getItem(a)});return t}},{key:"handleClick",value:function(e){var r=void 0;switch(e){case t.controlValues.FIRST:r=1;break;case t.controlValues.PREVIOUS:r=this.state.currentPage-1;break;case t.controlValues.NEXT:r=this.state.currentPage+1;break;case t.controlValues.LAST:r=this.state.numberOfPages;break;default:r=parseInt(e)}this.setState({currentPage:r,shownItems:this.generateItems(r)})}},{key:"renderControls",value:function(e){var t;return e=e.toLowerCase(),_react2.default.createElement(_UISegmentedControl2.default,_extends({},this.props.toggleWrapperProps,{ref:"segmentedControl"+(e[0].toUpperCase()+e.slice(1)),className:(0,_classnames2.default)((t={"ui-paginated-view-controls":!0},_defineProperty(t,"ui-paginated-view-controls-"+e,!0),_defineProperty(t,this.props.toggleWrapperProps.className,!!this.props.toggleWrapperProps.className),t)),options:this.createPageButtonOptions(),onOptionSelected:this.handleClick.bind(this)}))}},{key:"itemsToArray",value:function(){var e=[];return this.state.shownItems.map(function(t,r){e.push(_react2.default.createElement(_item2.default,{key:r,data:t.data,even:r%2===0}))}),e}},{key:"renderItems",value:function(){return _react2.default.createElement(_UIList2.default,_extends({},this.props.listWrapperProps,{ref:"itemList",className:(0,_classnames2.default)(_defineProperty({"ui-paginated-view-item-list":!0},this.props.listWrapperProps.className,!!this.props.listWrapperProps.className)),items:this.itemsToArray()}))}},{key:"renderView",value:function(){return _react2.default.createElement("div",{ref:"paginatedView",className:"ui-paginated-view"},this.props.position===t.position.ABOVE||this.props.position===t.position.BOTH?this.renderControls(t.position.ABOVE):_noop2.default,this.renderItems(),this.props.position===t.position.BELOW||this.props.position===t.position.BOTH?this.renderControls(t.position.BELOW):_noop2.default)}},{key:"render",value:function(){return _react2.default.createElement("div",_extends({},this.props,{ref:"wrapper",className:(0,_classnames2.default)(_defineProperty({"ui-paginated-view-wrapper":!0},this.props.className,!!this.props.className))}),this.renderView())}}]),t}(_UIView3.default);UIPaginatedView.controlValues={FIRST:"FIRST",PREVIOUS:"PREVIOUS",NEXT:"NEXT",LAST:"LAST"},UIPaginatedView.position={ABOVE:"ABOVE",BELOW:"BELOW",BOTH:"BOTH"},UIPaginatedView.propTypes={getItem:_react2.default.PropTypes.func,jumpToFirstControlText:_react2.default.PropTypes.string,jumpToLastControlText:_react2.default.PropTypes.string,listWrapperProps:_react2.default.PropTypes.object,nextPageControlText:_react2.default.PropTypes.string,numItemsPerPage:function(e,t,r){return Number.isInteger(e.numItemsPerPage)?e.numItemsPerPage<1||e.numItemsPerPage>e.totalItems?new Error("`numItemsPerPage` must be between 1 and "+e.totalItems+"."):void 0:new Error("`numItemsPerPage` must be an integer.")},numPageToggles:_react2.default.PropTypes.number,pagerPosition:function(e,t,r){if(!Number.isInteger(e.pagerPosition))return new Error("`pagerPosition` must be an integer.");var s=Math.ceil(e.totalItems/e.numItemsPerPage);return e.pagerPosition<1||e.pagerPosition>s?new Error("`pagerPosition` must be between 1 and "+s+"."):void 0},position:_react2.default.PropTypes.oneOf(Object.keys(UIPaginatedView.position)),previousPageControlText:_react2.default.PropTypes.string,showJumpToFirst:_react2.default.PropTypes.bool,showJumpToLast:_react2.default.PropTypes.bool,toggleWrapperProps:_react2.default.PropTypes.object,totalItems:_react2.default.PropTypes.number.isRequired},UIPaginatedView.defaultProps={options:[],getItem:_noop2.default,jumpToFirstControlText:"« First",jumpToLastControlText:"Last »",listWrapperProps:{},nextPageControlText:"Next ›",numItemsPerPage:10,numPageToggles:5,pagerPosition:1,position:UIPaginatedView.position.ABOVE,previousPageControlText:"‹ Previous",showJumpToFirst:!0,showJumpToLast:!0,toggleWrapperProps:{}},exports.default=UIPaginatedView;